# 📂 文件索引表

## 🔍 快速文件查找

### 📁 核心库文件 (Aga.Diagrams)

#### 🎨 装饰器 (Adorners)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `DragAdorner.cs` | `Aga.Diagrams/Adorners/` | 拖拽时的视觉反馈 |
| `LinkAdorner.cs` | `Aga.Diagrams/Adorners/` | 连接线创建预览 |
| `MoveResizeAdorner.cs` | `Aga.Diagrams/Adorners/` | 移动和调整大小装饰器 |
| `RubberbandAdorner.cs` | `Aga.Diagrams/Adorners/` | 橡皮筋选择框 |
| `SelectionAdorner.cs` | `Aga.Diagrams/Adorners/` | 选中状态装饰器 |

#### 🧩 控件 (Controls)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `DiagramItem.cs` | `Aga.Diagrams/Controls/` | 图表元素基类 |
| `DragThumb.cs` | `Aga.Diagrams/Controls/` | 拖拽控制点 |
| `SelectionFrame.cs` | `Aga.Diagrams/Controls/` | 选择框架 |

**节点相关 (Node)**
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `INode.cs` | `Aga.Diagrams/Controls/Node/` | 节点接口定义 |
| `Node.cs` | `Aga.Diagrams/Controls/Node/` | 节点控件实现 |

**端口相关 (Ports)**
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `IPort.cs` | `Aga.Diagrams/Controls/Ports/` | 端口接口定义 |
| `PortBase.cs` | `Aga.Diagrams/Controls/Ports/` | 端口基类 |
| `EllipsePort.cs` | `Aga.Diagrams/Controls/Ports/` | 圆形端口 |
| `RectPort.cs` | `Aga.Diagrams/Controls/Ports/` | 矩形端口 |

**连接线相关 (Links)**
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `ILink.cs` | `Aga.Diagrams/Controls/Links/` | 连接线接口 |
| `LinkBase.cs` | `Aga.Diagrams/Controls/Links/` | 连接线基类 |
| `SegmentLink.cs` | `Aga.Diagrams/Controls/Links/` | 分段连接线 |
| `LinkThumb.cs` | `Aga.Diagrams/Controls/Links/` | 连接线控制点 |
| `RelinkControl.cs` | `Aga.Diagrams/Controls/Links/` | 重新连接控制器 |

#### 🛠️ 工具 (Tools)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `IInputTool.cs` | `Aga.Diagrams/Tools/` | 输入工具接口 |
| `InputTool.cs` | `Aga.Diagrams/Tools/` | 基础输入处理 |
| `IMoveResizeTool.cs` | `Aga.Diagrams/Tools/` | 移动调整工具接口 |
| `MoveResizeTool.cs` | `Aga.Diagrams/Tools/` | 移动调整工具实现 |
| `ILinkTool.cs` | `Aga.Diagrams/Tools/` | 连接工具接口 |
| `LinkTool.cs` | `Aga.Diagrams/Tools/` | 连接工具实现 |
| `IDragDropTool.cs` | `Aga.Diagrams/Tools/` | 拖放工具接口 |

#### 🔧 工具类 (Util)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `GeometryHelper.cs` | `Aga.Diagrams/Util/` | 几何计算辅助 |
| `VisualHelper.cs` | `Aga.Diagrams/Util/` | 视觉树遍历辅助 |
| `DebuggingConverter.cs` | `Aga.Diagrams/Util/` | 调试转换器 |

#### 🎯 核心文件
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `DiagramView.cs` | `Aga.Diagrams/` | **核心画布控件** |
| `DiagramScrollView.cs` | `Aga.Diagrams/` | 带滚动的图表视图 |
| `IDiagramController.cs` | `Aga.Diagrams/` | **控制器接口** |
| `Selection.cs` | `Aga.Diagrams/` | **选择管理器** |
| `LinkInfo.cs` | `Aga.Diagrams/` | 连接信息结构 |

### 📁 示例应用 (TestApp)

#### 🌊 流程图示例 (Flowchart)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `Controller.cs` | `TestApp/Flowchart/` | **流程图控制器** |
| `FlowchartEditor.xaml.cs` | `TestApp/Flowchart/` | 流程图编辑器视图 |
| `CustomLinkTool.cs` | `TestApp/Flowchart/` | 自定义连接工具 |
| `CustomMoveResizeTool.cs` | `TestApp/Flowchart/` | 自定义移动工具 |
| `DragDropTool.cs` | `TestApp/Flowchart/` | 拖放工具实现 |
| `OrthogonalLink.cs` | `TestApp/Flowchart/` | 正交连接线 |

**数据模型 (Model)**
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `FlowchartModel.cs` | `TestApp/Flowchart/Model/` | 流程图数据模型 |
| `FlowNode.cs` | `TestApp/Flowchart/Model/` | 流程节点模型 |
| `Link.cs` | `TestApp/Flowchart/Model/` | 连接线模型 |

#### 🔷 图形示例 (ShapesExample)
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `Shapes.cs` | `TestApp/ShapesExample/` | 基础图形定义 |
| `ShapesController.cs` | `TestApp/ShapesExample/` | 图形控制器 |
| `ShapesEditor.xaml.cs` | `TestApp/ShapesExample/` | 图形编辑器 |

#### 🏠 应用入口
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `App.xaml.cs` | `TestApp/` | 应用程序入口 |
| `MainWindow.xaml.cs` | `TestApp/` | 主窗口 |
| `PropertiesView.xaml.cs` | `TestApp/` | 属性视图 |
| `CollectionHelper.cs` | `TestApp/` | 集合辅助类 |
| `ItemsControlDragHelper.cs` | `TestApp/` | 拖拽辅助类 |

### 📁 样式文件 (themes)

#### 🎨 XAML模板和样式
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `generic.xaml` | `Aga.Diagrams/themes/` | **通用样式定义** |
| `Shared.xaml` | `Aga.Diagrams/themes/` | 共享资源 |
| `DiagramView.xaml` | `Aga.Diagrams/themes/` | DiagramView控件模板 |
| `Node.xaml` | `Aga.Diagrams/themes/` | Node控件模板 |
| `LinkBase.xaml` | `Aga.Diagrams/themes/` | 连接线样式 |
| `EllipsePort.xaml` | `Aga.Diagrams/themes/` | 圆形端口样式 |
| `RectPort.xaml` | `Aga.Diagrams/themes/` | 矩形端口样式 |
| `SelectionFrame.xaml` | `Aga.Diagrams/themes/` | 选择框样式 |
| `RelinkControl.xaml` | `Aga.Diagrams/themes/` | 重连控制器样式 |

#### 🖼️ 应用界面
| 文件名 | 路径 | 主要功能 |
|--------|------|----------|
| `App.xaml` | `TestApp/` | 应用资源定义 |
| `MainWindow.xaml` | `TestApp/` | 主窗口界面 |
| `PropertiesView.xaml` | `TestApp/` | 属性视图界面 |
| `FlowchartEditor.xaml` | `TestApp/Flowchart/` | 流程图编辑器界面 |
| `ShapesEditor.xaml` | `TestApp/ShapesExample/` | 图形编辑器界面 |

---

## 🔗 关键类关系

### 继承关系
```
Control
├── DiagramItem (抽象基类)
│   ├── Node (节点)
│   └── LinkBase (连接线基类)
│       └── SegmentLink (分段连接线)
└── Canvas
    └── DiagramView (画布)
```

### 接口实现
```
INode ← Node
IPort ← PortBase ← EllipsePort, RectPort  
ILink ← LinkBase ← SegmentLink
IDiagramController ← Controller (TestApp)
IInputTool ← InputTool
```

### 核心交互流
```
用户操作 → DiagramView → InputTool → 具体工具 → Adorner → Controller → Model
```

---

## 📚 学习路径建议

### 🥇 初级 - 了解基础结构
1. **DiagramView.cs** - 理解核心画布
2. **DiagramItem.cs** - 掌握元素基类
3. **Selection.cs** - 学习选择管理

### 🥈 中级 - 掌握交互机制  
1. **InputTool.cs** - 理解事件处理
2. **Node.cs** - 学习节点实现
3. **Adorners/** - 掌握装饰器系统

### 🥉 高级 - 深入定制开发
1. **Controller.cs** (TestApp) - 学习MVVM应用
2. **Tools/** - 理解工具扩展
3. **themes/** - 掌握样式定制

---

## 🔍 快捷查找

### 按功能查找
- **事件处理**: `InputTool.cs`, `DiagramView.cs`
- **视觉反馈**: `Adorners/` 目录下所有文件
- **数据绑定**: `Controller.cs`, `Selection.cs`
- **自定义样式**: `themes/` 目录下所有 `.xaml` 文件
- **扩展示例**: `TestApp/Flowchart/` 目录

### 按接口查找
- **INode接口**: `Controls/Node/INode.cs`
- **IPort接口**: `Controls/Ports/IPort.cs`
- **ILink接口**: `Controls/Links/ILink.cs`
- **控制器接口**: `IDiagramController.cs`

### 按关键词查找
- **拖拽**: `DragAdorner.cs`, `DragThumb.cs`, `MoveResizeTool.cs`
- **选择**: `Selection.cs`, `SelectionAdorner.cs`, `RubberbandAdorner.cs`
- **连接**: `LinkTool.cs`, `LinkAdorner.cs`, `LinkBase.cs`
- **端口**: `Ports/` 目录下所有文件