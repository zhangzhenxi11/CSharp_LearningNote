# ğŸ“‚ æ–‡ä»¶ç´¢å¼•è¡¨

## ğŸ” å¿«é€Ÿæ–‡ä»¶æŸ¥æ‰¾

### ğŸ“ æ ¸å¿ƒåº“æ–‡ä»¶ (Aga.Diagrams)

#### ğŸ¨ è£…é¥°å™¨ (Adorners)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `DragAdorner.cs` | `Aga.Diagrams/Adorners/` | æ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆ |
| `LinkAdorner.cs` | `Aga.Diagrams/Adorners/` | è¿æ¥çº¿åˆ›å»ºé¢„è§ˆ |
| `MoveResizeAdorner.cs` | `Aga.Diagrams/Adorners/` | ç§»åŠ¨å’Œè°ƒæ•´å¤§å°è£…é¥°å™¨ |
| `RubberbandAdorner.cs` | `Aga.Diagrams/Adorners/` | æ©¡çš®ç­‹é€‰æ‹©æ¡† |
| `SelectionAdorner.cs` | `Aga.Diagrams/Adorners/` | é€‰ä¸­çŠ¶æ€è£…é¥°å™¨ |

#### ğŸ§© æ§ä»¶ (Controls)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `DiagramItem.cs` | `Aga.Diagrams/Controls/` | å›¾è¡¨å…ƒç´ åŸºç±» |
| `DragThumb.cs` | `Aga.Diagrams/Controls/` | æ‹–æ‹½æ§åˆ¶ç‚¹ |
| `SelectionFrame.cs` | `Aga.Diagrams/Controls/` | é€‰æ‹©æ¡†æ¶ |

**èŠ‚ç‚¹ç›¸å…³ (Node)**
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `INode.cs` | `Aga.Diagrams/Controls/Node/` | èŠ‚ç‚¹æ¥å£å®šä¹‰ |
| `Node.cs` | `Aga.Diagrams/Controls/Node/` | èŠ‚ç‚¹æ§ä»¶å®ç° |

**ç«¯å£ç›¸å…³ (Ports)**
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `IPort.cs` | `Aga.Diagrams/Controls/Ports/` | ç«¯å£æ¥å£å®šä¹‰ |
| `PortBase.cs` | `Aga.Diagrams/Controls/Ports/` | ç«¯å£åŸºç±» |
| `EllipsePort.cs` | `Aga.Diagrams/Controls/Ports/` | åœ†å½¢ç«¯å£ |
| `RectPort.cs` | `Aga.Diagrams/Controls/Ports/` | çŸ©å½¢ç«¯å£ |

**è¿æ¥çº¿ç›¸å…³ (Links)**
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `ILink.cs` | `Aga.Diagrams/Controls/Links/` | è¿æ¥çº¿æ¥å£ |
| `LinkBase.cs` | `Aga.Diagrams/Controls/Links/` | è¿æ¥çº¿åŸºç±» |
| `SegmentLink.cs` | `Aga.Diagrams/Controls/Links/` | åˆ†æ®µè¿æ¥çº¿ |
| `LinkThumb.cs` | `Aga.Diagrams/Controls/Links/` | è¿æ¥çº¿æ§åˆ¶ç‚¹ |
| `RelinkControl.cs` | `Aga.Diagrams/Controls/Links/` | é‡æ–°è¿æ¥æ§åˆ¶å™¨ |

#### ğŸ› ï¸ å·¥å…· (Tools)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `IInputTool.cs` | `Aga.Diagrams/Tools/` | è¾“å…¥å·¥å…·æ¥å£ |
| `InputTool.cs` | `Aga.Diagrams/Tools/` | åŸºç¡€è¾“å…¥å¤„ç† |
| `IMoveResizeTool.cs` | `Aga.Diagrams/Tools/` | ç§»åŠ¨è°ƒæ•´å·¥å…·æ¥å£ |
| `MoveResizeTool.cs` | `Aga.Diagrams/Tools/` | ç§»åŠ¨è°ƒæ•´å·¥å…·å®ç° |
| `ILinkTool.cs` | `Aga.Diagrams/Tools/` | è¿æ¥å·¥å…·æ¥å£ |
| `LinkTool.cs` | `Aga.Diagrams/Tools/` | è¿æ¥å·¥å…·å®ç° |
| `IDragDropTool.cs` | `Aga.Diagrams/Tools/` | æ‹–æ”¾å·¥å…·æ¥å£ |

#### ğŸ”§ å·¥å…·ç±» (Util)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `GeometryHelper.cs` | `Aga.Diagrams/Util/` | å‡ ä½•è®¡ç®—è¾…åŠ© |
| `VisualHelper.cs` | `Aga.Diagrams/Util/` | è§†è§‰æ ‘éå†è¾…åŠ© |
| `DebuggingConverter.cs` | `Aga.Diagrams/Util/` | è°ƒè¯•è½¬æ¢å™¨ |

#### ğŸ¯ æ ¸å¿ƒæ–‡ä»¶
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `DiagramView.cs` | `Aga.Diagrams/` | **æ ¸å¿ƒç”»å¸ƒæ§ä»¶** |
| `DiagramScrollView.cs` | `Aga.Diagrams/` | å¸¦æ»šåŠ¨çš„å›¾è¡¨è§†å›¾ |
| `IDiagramController.cs` | `Aga.Diagrams/` | **æ§åˆ¶å™¨æ¥å£** |
| `Selection.cs` | `Aga.Diagrams/` | **é€‰æ‹©ç®¡ç†å™¨** |
| `LinkInfo.cs` | `Aga.Diagrams/` | è¿æ¥ä¿¡æ¯ç»“æ„ |

### ğŸ“ ç¤ºä¾‹åº”ç”¨ (TestApp)

#### ğŸŒŠ æµç¨‹å›¾ç¤ºä¾‹ (Flowchart)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `Controller.cs` | `TestApp/Flowchart/` | **æµç¨‹å›¾æ§åˆ¶å™¨** |
| `FlowchartEditor.xaml.cs` | `TestApp/Flowchart/` | æµç¨‹å›¾ç¼–è¾‘å™¨è§†å›¾ |
| `CustomLinkTool.cs` | `TestApp/Flowchart/` | è‡ªå®šä¹‰è¿æ¥å·¥å…· |
| `CustomMoveResizeTool.cs` | `TestApp/Flowchart/` | è‡ªå®šä¹‰ç§»åŠ¨å·¥å…· |
| `DragDropTool.cs` | `TestApp/Flowchart/` | æ‹–æ”¾å·¥å…·å®ç° |
| `OrthogonalLink.cs` | `TestApp/Flowchart/` | æ­£äº¤è¿æ¥çº¿ |

**æ•°æ®æ¨¡å‹ (Model)**
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `FlowchartModel.cs` | `TestApp/Flowchart/Model/` | æµç¨‹å›¾æ•°æ®æ¨¡å‹ |
| `FlowNode.cs` | `TestApp/Flowchart/Model/` | æµç¨‹èŠ‚ç‚¹æ¨¡å‹ |
| `Link.cs` | `TestApp/Flowchart/Model/` | è¿æ¥çº¿æ¨¡å‹ |

#### ğŸ”· å›¾å½¢ç¤ºä¾‹ (ShapesExample)
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `Shapes.cs` | `TestApp/ShapesExample/` | åŸºç¡€å›¾å½¢å®šä¹‰ |
| `ShapesController.cs` | `TestApp/ShapesExample/` | å›¾å½¢æ§åˆ¶å™¨ |
| `ShapesEditor.xaml.cs` | `TestApp/ShapesExample/` | å›¾å½¢ç¼–è¾‘å™¨ |

#### ğŸ  åº”ç”¨å…¥å£
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `App.xaml.cs` | `TestApp/` | åº”ç”¨ç¨‹åºå…¥å£ |
| `MainWindow.xaml.cs` | `TestApp/` | ä¸»çª—å£ |
| `PropertiesView.xaml.cs` | `TestApp/` | å±æ€§è§†å›¾ |
| `CollectionHelper.cs` | `TestApp/` | é›†åˆè¾…åŠ©ç±» |
| `ItemsControlDragHelper.cs` | `TestApp/` | æ‹–æ‹½è¾…åŠ©ç±» |

### ğŸ“ æ ·å¼æ–‡ä»¶ (themes)

#### ğŸ¨ XAMLæ¨¡æ¿å’Œæ ·å¼
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `generic.xaml` | `Aga.Diagrams/themes/` | **é€šç”¨æ ·å¼å®šä¹‰** |
| `Shared.xaml` | `Aga.Diagrams/themes/` | å…±äº«èµ„æº |
| `DiagramView.xaml` | `Aga.Diagrams/themes/` | DiagramViewæ§ä»¶æ¨¡æ¿ |
| `Node.xaml` | `Aga.Diagrams/themes/` | Nodeæ§ä»¶æ¨¡æ¿ |
| `LinkBase.xaml` | `Aga.Diagrams/themes/` | è¿æ¥çº¿æ ·å¼ |
| `EllipsePort.xaml` | `Aga.Diagrams/themes/` | åœ†å½¢ç«¯å£æ ·å¼ |
| `RectPort.xaml` | `Aga.Diagrams/themes/` | çŸ©å½¢ç«¯å£æ ·å¼ |
| `SelectionFrame.xaml` | `Aga.Diagrams/themes/` | é€‰æ‹©æ¡†æ ·å¼ |
| `RelinkControl.xaml` | `Aga.Diagrams/themes/` | é‡è¿æ§åˆ¶å™¨æ ·å¼ |

#### ğŸ–¼ï¸ åº”ç”¨ç•Œé¢
| æ–‡ä»¶å | è·¯å¾„ | ä¸»è¦åŠŸèƒ½ |
|--------|------|----------|
| `App.xaml` | `TestApp/` | åº”ç”¨èµ„æºå®šä¹‰ |
| `MainWindow.xaml` | `TestApp/` | ä¸»çª—å£ç•Œé¢ |
| `PropertiesView.xaml` | `TestApp/` | å±æ€§è§†å›¾ç•Œé¢ |
| `FlowchartEditor.xaml` | `TestApp/Flowchart/` | æµç¨‹å›¾ç¼–è¾‘å™¨ç•Œé¢ |
| `ShapesEditor.xaml` | `TestApp/ShapesExample/` | å›¾å½¢ç¼–è¾‘å™¨ç•Œé¢ |

---

## ğŸ”— å…³é”®ç±»å…³ç³»

### ç»§æ‰¿å…³ç³»
```
Control
â”œâ”€â”€ DiagramItem (æŠ½è±¡åŸºç±»)
â”‚   â”œâ”€â”€ Node (èŠ‚ç‚¹)
â”‚   â””â”€â”€ LinkBase (è¿æ¥çº¿åŸºç±»)
â”‚       â””â”€â”€ SegmentLink (åˆ†æ®µè¿æ¥çº¿)
â””â”€â”€ Canvas
    â””â”€â”€ DiagramView (ç”»å¸ƒ)
```

### æ¥å£å®ç°
```
INode â† Node
IPort â† PortBase â† EllipsePort, RectPort  
ILink â† LinkBase â† SegmentLink
IDiagramController â† Controller (TestApp)
IInputTool â† InputTool
```

### æ ¸å¿ƒäº¤äº’æµ
```
ç”¨æˆ·æ“ä½œ â†’ DiagramView â†’ InputTool â†’ å…·ä½“å·¥å…· â†’ Adorner â†’ Controller â†’ Model
```

---

## ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®®

### ğŸ¥‡ åˆçº§ - äº†è§£åŸºç¡€ç»“æ„
1. **DiagramView.cs** - ç†è§£æ ¸å¿ƒç”»å¸ƒ
2. **DiagramItem.cs** - æŒæ¡å…ƒç´ åŸºç±»
3. **Selection.cs** - å­¦ä¹ é€‰æ‹©ç®¡ç†

### ğŸ¥ˆ ä¸­çº§ - æŒæ¡äº¤äº’æœºåˆ¶  
1. **InputTool.cs** - ç†è§£äº‹ä»¶å¤„ç†
2. **Node.cs** - å­¦ä¹ èŠ‚ç‚¹å®ç°
3. **Adorners/** - æŒæ¡è£…é¥°å™¨ç³»ç»Ÿ

### ğŸ¥‰ é«˜çº§ - æ·±å…¥å®šåˆ¶å¼€å‘
1. **Controller.cs** (TestApp) - å­¦ä¹ MVVMåº”ç”¨
2. **Tools/** - ç†è§£å·¥å…·æ‰©å±•
3. **themes/** - æŒæ¡æ ·å¼å®šåˆ¶

---

## ğŸ” å¿«æ·æŸ¥æ‰¾

### æŒ‰åŠŸèƒ½æŸ¥æ‰¾
- **äº‹ä»¶å¤„ç†**: `InputTool.cs`, `DiagramView.cs`
- **è§†è§‰åé¦ˆ**: `Adorners/` ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
- **æ•°æ®ç»‘å®š**: `Controller.cs`, `Selection.cs`
- **è‡ªå®šä¹‰æ ·å¼**: `themes/` ç›®å½•ä¸‹æ‰€æœ‰ `.xaml` æ–‡ä»¶
- **æ‰©å±•ç¤ºä¾‹**: `TestApp/Flowchart/` ç›®å½•

### æŒ‰æ¥å£æŸ¥æ‰¾
- **INodeæ¥å£**: `Controls/Node/INode.cs`
- **IPortæ¥å£**: `Controls/Ports/IPort.cs`
- **ILinkæ¥å£**: `Controls/Links/ILink.cs`
- **æ§åˆ¶å™¨æ¥å£**: `IDiagramController.cs`

### æŒ‰å…³é”®è¯æŸ¥æ‰¾
- **æ‹–æ‹½**: `DragAdorner.cs`, `DragThumb.cs`, `MoveResizeTool.cs`
- **é€‰æ‹©**: `Selection.cs`, `SelectionAdorner.cs`, `RubberbandAdorner.cs`
- **è¿æ¥**: `LinkTool.cs`, `LinkAdorner.cs`, `LinkBase.cs`
- **ç«¯å£**: `Ports/` ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶